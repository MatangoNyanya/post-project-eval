# Auto-generated from 60_assign_toughness.ipynb
# Do not edit this file directly; edit the notebook instead.

# %%

import pandas as pd
df = pd.read_csv("df_check_11.csv", index_col=0)
df

# %%

li = df['評価会社'].unique().tolist()
li

# %%

def replace_value(df: pd.DataFrame, colname: str, li: list, repword) -> pd.DataFrame:
    """
    dfのcolnameのカラムについて、liで設定されたリストの値をrepwordの値に置換する
    """
    out = df.copy()
    out[colname] = out[colname].replace(li, repword)
    return out

# %%

li=[
 '(株)グローバル・グループ 21 ジャパン',
 '（株）グローバル・グループ 21 ジャパン',
 '(株)グローバル・グループ21 ジャパン',
 '(株)グローバル・グループ21ジャパン',
 '株式会社グローバル・グループ 21 ジャパン',
 '株式会社グローバル・グループ21 ジャパン',
 '株式会社グローバル・グループ21ジャパン',
 '株式会社グローバルグループ21ジャパン',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社グローバル・グループ21ジャパン")

# %%

li=[
 '(株) タックインターナショナル',
 '(株)タックインターナショナル',
 'タック・インターナショナル',
 '株式会社タックインターナショナル',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社タック・インターナショナル")

# %%

li=[
 'EY 新日本サステナビリティ(株)',
 'EY 新日本有限責任監査法人',
 'EYアドバイザリー・アンド・コンサルティング株式会社',
 'EY新日本有限責任監査法人',
 'アーンスト・アンド・ヤング・アドバイザリー(株)',
 'アーンスト・アンド・ヤング・アドバイザリー株式会社',
 '新日本サステナビリティ(株)',
 '新日本サステナビリティ株式会社',
 '新日本有限責任監査法人'
]
df = replace_value(df=df, colname="評価会社", li=li, repword="EY 新日本サステナビリティ株式会社")

# %%

li=[
 '(一般財団法人)国際開発機構',
 '一般財団法人 国際開発機構',
 '一般財団法人国際開発機構',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="一般財団法人国際開発機構")

# %%

li=[
 '(株)国際開発センター',
 '株式会社 国際開発センター',
 '国際開発センター',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社国際開発センター")

# %%

li=[
 'アイ・シー・ネット(株)',
 'アイシーネット株式会社',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="アイ・シー・ネット株式会社")

# %%

li=[
 '三菱 UFJ リサーチ&コンサルティング株式会社',
 '三菱 UFJリサーチ&コンサルティング株式会社',
 '三菱UFJリサーチ&コンサルティング',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="三菱UFJリサーチ&コンサルティング株式会社")

# %%

li=[
 '三菱 UFJ リサーチ&コンサルティング株式会社, PB ジャパン株式会社',
 '三菱UFJリサーチ&コンサルティング株式会社, PB ジャパン株式会社',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="三菱UFJリサーチ&コンサルティング株式会社, PBジャパン株式会社")

# %%

li=[
 '三菱 UFJ リサーチ&コンサルティング株式会社, PB ジャパン株式会社',
 '三菱UFJリサーチ&コンサルティング株式会社, PB ジャパン株式会社',
 '三菱UFJリサーチ&コンサルティング株式会社',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="三菱UFJリサーチ&コンサルティング株式会社, PBジャパン株式会社")

# %%

li=[
 'アルメック VPI',
 '株式会社アルメック VPI',
 '株式会社アルメックVPI',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社アルメック")

# %%

li=[
 'Value Frontier 株式会社',
 'Value Frontier(株)',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="Value Frontier 株式会社")

# %%

li=[
 '（財）国際開発高等教育機構',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="財団法人国際開発高等教育機構")

# %%

li=[
 'インテムコンサルティング',
 'インテムコンサルティング株式会社',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="インテムコンサルティング株式会社")

# %%

li=[
 '株式会社アースアンドコーポレーション',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社アースアンドヒューマンコーポレーション")

# %%

li=[
 'コーエイ総合研究所',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社コーエイ総合研究所")

# %%

li=[
 '株式会社日本経済研究所',
 '日本経済研究所',
]
df = replace_value(df=df, colname="評価会社", li=li, repword="株式会社日本経済研究所")

# %%

# jica事務所の表記揺れ修正
df['評価会社'] = df['評価会社'].astype(str).str.replace('東チモール事務所', '東ティモール事務所', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('中華人民共和国事務所', '中国事務所', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('JICA', '', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace(' ', '', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('　', '', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('民主共和国', '', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('共和国', '', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('支所', '事務所', regex=False)
df['評価会社'] = df['評価会社'].astype(str).str.replace('駐在員', '', regex=False)

# %%

no_replace = ['中国事務所', '中華人民共和国事務所']

df['評価会社'] = df['評価会社'].apply(
    lambda s: (
        s
        if isinstance(s, str) and s in no_replace
        else (s.replace('国事務所', '事務所') if isinstance(s, str) else s)
    )
)

# %%

col = '評価会社' 
unique_sorted = sorted(df[col].dropna().unique())

# %%

df.to_csv("df_check_12.csv")
print(f"レコード数: {len(df)}")
# %%


# %%

